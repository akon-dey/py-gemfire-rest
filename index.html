<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Py-gemfire-rest : Python client for Gemfire&#39;s REST service.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Py-gemfire-rest</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/gemfire/py-gemfire-rest">View on GitHub</a>

          <h1 id="project_title">Py-gemfire-rest</h1>
          <h2 id="project_tagline">Python client for Gemfire&#39;s REST service.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/gemfire/py-gemfire-rest/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/gemfire/py-gemfire-rest/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>Python Client for GemFire</p>

<hr><p>For a quick getting started guide please see README for the project at <a href="https://github.com/gemfire/py-gemfire-rest">https://github.com/gemfire/py-gemfire-rest</a></p>

<p>With the 8.0 release, GemFire now supports a RESTful API enabling any programming language to be used for writing highly scalable applications. We have also released an open-source implementation of a python package (<a href="https://github.com/gemfire/py-gemfire-rest">https://github.com/gemfire/py-gemfire-rest</a>) that utilizes GemFire’s REST API.
With this package:</p>

<ul>
<li>Your application can define the data models entirely in python. (We require that you add “id” instance variable)</li>
<li>Use Spring’s CrudRepository like interface to store/access your data.</li>
</ul><p>Say, you want to create a simple social networking application in which you store user profiles and the posts they make. This means your two classes could be defined as:</p>

<div class="highlight highlight-python"><pre><span class="k">class</span> <span class="nc">Profile</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">friends</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">friends</span> <span class="o">=</span> <span class="n">friends</span>

<span class="k">class</span> <span class="nc">Posts</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">author</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>
</pre></div>

<h1>
<a name="starting-the-gemfire-data-grid" class="anchor" href="#starting-the-gemfire-data-grid"><span class="octicon octicon-link"></span></a>Starting the GemFire data grid</h1>

<hr><p>Please <a href="http://gemfire.docs.pivotal.io/latest/userguide/index.html#getting_started/install_intro.html">install GemFire for your operating system</a>. Now, let us start a GemFire cluster to store your data; GemFire cluster is made up of two types of members, “locators” and “servers”. A locator is a service that enables GemFire servers to discover each other, facilitates load balancing etc. From GemFireSHell (gfsh) start a locator as follows: (For high availability, you should start more than one locator per cluster)</p>

<pre lang="shell"><code>gfsh&gt;start locator --name=locator1
</code></pre>

<p>A GemFire “server” is a process which manages your data. All nodes talk to one another. A server can be stated as follows</p>

<pre lang="shell"><code>gfsh&gt;start server --name=server1
</code></pre>

<p>A server with a REST endpoint can be stated as follows</p>

<pre lang="shell"><code>gfsh&gt;start server --name=server2 --J=-Dgemfire.start-dev-rest-api=true --J=-Dgemfire.http-service-port=8080
</code></pre>

<p>Let us create Regions (RDBMS equivalent of Tables) to stores this data</p>

<pre lang="shell"><code>gfsh&gt;create region --name=profiles --type=REPLICATE
</code></pre>

<p>A replicate region maintains a copy of the entire data on each server</p>

<pre lang="shell"><code>gfsh&gt;create region --name=posts --type=PARTITION
</code></pre>

<p>A partitioned region splits its contents among all servers</p>

<h1>
<a name="writing-python-application" class="anchor" href="#writing-python-application"><span class="octicon octicon-link"></span></a>Writing Python Application</h1>

<hr><p>Now that we have the GemFire RESTful service started, we can create our client instance and store data:</p>

<div class="highlight highlight-python"><pre><span class="c">#create client using hostname and port of GemFire’s REST service endpoint</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">GemfireClient</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s">"localhost"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</pre></div>

<p><a href="#gemfireclient-api">All methods on GemfireClient</a>. From this client we can create repositories for storing our entities</p>

<div class="highlight highlight-python"><pre><span class="c">#create a repository for storing profiles</span>
<span class="n">profiles</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_repository</span><span class="p">(</span><span class="s">"profiles"</span><span class="p">)</span>

<span class="c">#save profiles in GemFire</span>
<span class="n">user1</span> <span class="o">=</span> <span class="n">Profile</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"Ethan"</span><span class="p">)</span>
<span class="n">profiles</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">user1</span><span class="p">)</span>

<span class="c">#you can also pass a list of entities, efficient for bulk loading</span>
<span class="n">post1</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"Ethan"</span><span class="p">,</span> <span class="s">"Eating Toast!"</span><span class="p">)</span>
<span class="n">post2</span> <span class="o">=</span> <span class="n">Post</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"Isabella"</span><span class="p">,</span> <span class="s">"Drinking Coffee"</span><span class="p">)</span>
<span class="n">posts</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_repository</span><span class="p">(</span><span class="s">"posts"</span><span class="p">)</span>
<span class="n">posts</span><span class="o">.</span><span class="n">save</span><span class="p">([</span><span class="n">post1</span><span class="p">,</span> <span class="n">post2</span><span class="p">])</span>

<span class="c"># find an existing profile</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">profiles</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

<p><a href="#repository-api">All methods on Repository</a></p>

<p>For specialized operations like compare_and_set, putIfAbsent etc. you can obtain the Region directly from the repository:</p>

<div class="highlight highlight-python"><pre><span class="n">profile_region</span> <span class="o">=</span> <span class="n">profiles</span><span class="o">.</span><span class="n">get_region</span><span class="p">()</span>
</pre></div>

<p><a href="#region-api">All methods on Region</a></p>

<h1>
<a name="query" class="anchor" href="#query"><span class="octicon octicon-link"></span></a>Query</h1>

<hr><p>GemFire supports OQL queries. For an example, let us say we want to get all posts by Ethan. We can write an ad-hoc query as follows:</p>

<div class="highlight highlight-python"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">adhoc_query</span><span class="p">(</span><span class="s">"select * from /posts where author='Ethan' "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">status</span>
</pre></div>

<h3>
<a name="prepared-query" class="anchor" href="#prepared-query"><span class="octicon octicon-link"></span></a>Prepared Query</h3>

<hr><p>When we want to use the above query for a different author, we can create a prepared query by passing an identifier for the prepared query along with the actual query string. We can use the identifier to run a prepared query at a later point. In the below example, we create a prepared query identified by “all_posts” and later use that identifier to run the query by passing in the parameters.</p>

<div class="highlight highlight-python"><pre>    <span class="n">client</span><span class="o">.</span><span class="n">new_query</span><span class="p">(</span><span class="s">"all_posts"</span><span class="p">,</span> <span class="s">"select * from /posts where author=$1"</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="s">"all_posts"</span><span class="p">,</span> <span class="s">"Ethan"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">status</span>
</pre></div>

<h1>
<a name="accessing-data-from-other-languages" class="anchor" href="#accessing-data-from-other-languages"><span class="octicon octicon-link"></span></a>Accessing data from Other Languages</h1>

<hr><p>GemFire internally saves this data in its Portable Data eXchange format (PDX), so it is possible to access and modify the data inserted from python in other languages. The following code snippet demonstrates how this can be done from GemFire’s Java client:</p>

<div class="highlight highlight-java"><pre><span class="c1">//create a client-cache to access server data</span>
<span class="n">ClientCacheFactory</span> <span class="n">cf</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ClientCacheFactory</span><span class="o">();</span>
<span class="n">cf</span><span class="o">.</span><span class="na">addPoolLocator</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">10334</span><span class="o">);</span>
<span class="n">ClientCache</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>

<span class="c1">//create a reference to the region on the client</span>
<span class="n">ClientRegionFactory</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Profile</span><span class="o">&gt;</span> <span class="n">rf</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="na">createClientRegionFactory</span><span class="o">(</span><span class="n">ClientRegionShortcut</span><span class="o">.</span><span class="na">PROXY</span><span class="o">);</span>
<span class="n">Region</span> <span class="n">profiles</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"profiles"</span><span class="o">);</span>

<span class="c1">//get the profile for user id 1</span>
<span class="n">PdxInstance</span> <span class="n">user1</span> <span class="o">=</span> <span class="o">(</span><span class="n">PdxInstance</span><span class="o">)</span> <span class="n">profiles</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"1"</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"get returned:"</span><span class="o">+</span><span class="n">user1</span><span class="o">.</span><span class="na">getField</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span> <span class="c1">//prints Ethan</span>

<span class="c1">// modify the profile</span>
<span class="n">WritablePdxInstance</span> <span class="n">userModified</span> <span class="o">=</span> <span class="n">user1</span><span class="o">.</span><span class="na">createWriter</span><span class="o">();</span>
<span class="n">userModified</span><span class="o">.</span><span class="na">setField</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"Ethan Jr"</span><span class="o">);</span>
<span class="n">profiles</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="n">userModified</span><span class="o">);</span>
</pre></div>

<h1>
<a name="api" class="anchor" href="#api"><span class="octicon octicon-link"></span></a>API</h1>

<hr><p>A complete list of methods for GemfireClient, Repository and Region modules:</p>

<p><a name="gemfireclient-api"></a></p>

<h3>
<a name="gemfireclient" class="anchor" href="#gemfireclient"><span class="octicon octicon-link"></span></a>GemfireClient</h3>

<div class="highlight highlight-python"><pre><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">debug_mode</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
      <span class="c">#Initializes the Client with the given hostname and port</span>

<span class="n">adhoc_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
      <span class="c">#Runs an adhoc Query</span>

<span class="n">connection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Checks connection to the server</span>

<span class="n">create_repository</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
      <span class="c">#Initializes and returns a Repository Object</span>

<span class="n">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
      <span class="c">#Processes HTTP error responses</span>

<span class="n">execute_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">func_id</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="c">#Run function</span>

<span class="n">list_all_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#List all stored function ID's stored on server</span>

<span class="n">list_all_queries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Lists all stored Queries in the server</span>

<span class="n">list_all_regions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Lists all names of Regions present in the server</span>

<span class="n">new_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_id</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)</span>
      <span class="c">#Creates a new Query and adds it to the server</span>

<span class="n">run_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_id</span><span class="p">,</span> <span class="n">query_args</span><span class="p">)</span>
      <span class="c">#Runs the Query with specified parameters</span>
</pre></div>

<p><a name="repository-api"></a></p>

<h3>
<a name="repository" class="anchor" href="#repository"><span class="octicon octicon-link"></span></a>Repository</h3>

<div class="highlight highlight-python"><pre><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
      <span class="c">#Initializes a Repository</span>

<span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="p">)</span>
      <span class="c">#Deletes the specified Object from the region</span>

<span class="n">delete_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Deletes all data in the region</span>

<span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
      <span class="c">#Checks whether an Object with the given id exists</span>

<span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
      <span class="c">#Retrieves Object(s) by the given ID(s) from the region</span>

<span class="n">find_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Returns all data in the region</span>

<span class="n">get_region</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Instantiates and returns a Region object</span>

<span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entities</span><span class="p">)</span>
      <span class="c">#Saves(s) all given Objects in the region</span>

</pre></div>

<p><a name="region-api"></a></p>

<h3>
<a name="region" class="anchor" href="#region"><span class="octicon octicon-link"></span></a>Region</h3>

<div class="highlight highlight-python"><pre><span class="n">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
      <span class="c">#Method to support region[key] notion</span>

<span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>
      <span class="c">#Initializes a Region</span>

<span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Deletes all data in the Region</span>

<span class="n">compare_and_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">oldvalue</span><span class="p">,</span> <span class="n">newvalue</span><span class="p">)</span>
      <span class="c">#Compares old values and if identical replaces with a new value</span>

<span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="c">#Creates a new data value in the Region if the key is absent</span>

<span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
      <span class="c">#Deletes the corresponding data value for the specified key</span>

<span class="n">error_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
      <span class="c">#Processes HTTP error responses</span>

<span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
      <span class="c">#Returns the data value for a specified key</span>

<span class="n">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Returns all the data in a Region</span>

<span class="n">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="c">#Returns all keys in the Region</span>

<span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="c">#Updates or inserts data for a specified key</span>

<span class="n">put_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
      <span class="c">#Insert or updates data for multiple keys specified by a hashtable</span>

<span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="c">#Updates the data in a region only if the specified key is present</span>

</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Py-gemfire-rest maintained by <a href="https://github.com/gemfire">gemfire</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
