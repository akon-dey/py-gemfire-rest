<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Py-gemfire-rest : Python client for Gemfire&#39;s REST service.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Py-gemfire-rest</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/gemfire/py-gemfire-rest">View on GitHub</a>

          <h1 id="project_title">Py-gemfire-rest</h1>
          <h2 id="project_tagline">Python client for Gemfire&#39;s REST service.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/gemfire/py-gemfire-rest/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/gemfire/py-gemfire-rest/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="py-gemfire-rest" class="anchor" href="#py-gemfire-rest"><span class="octicon octicon-link"></span></a>py-gemfire-rest</h1>

<h1></h1>

<p>For a quick getting started guide please see README for the project at <a href="https://github.com/gemfire/py-gemfire-rest">https://github.com/gemfire/py-gemfire-rest</a></p>

<p>With the 8.0 release, GemFire now supports a RESTful API enabling any programming language to be used for writing highly scalable applications. We have also released an open-source implementation of a python package (<a href="https://github.com/gemfire/py-gemfire-rest">https://github.com/gemfire/py-gemfire-rest</a>) that utilizes GemFire’s REST API.
With this package:</p>

<ul>
<li>Your application can define the data models entirely in python. (We require that you add “id” instance variable)</li>
<li>Use Spring’s CrudRepository like interface to store/access your data.</li>
</ul><p>Say, you want to create a simple social networking application in which you store user profiles and the posts they make. This means your two classes could be defined as:</p>

<pre><code>class Profile:
    def __init__(self, id, name, friends=None):
        self.id = id
        self.name = name
        self.friends = friends

class Posts:
    def __init__(self, id, author, status, timestamp=time.clock()):
        self.id = id
        self.author = author
        self.status = status
        self.timestamp = timestamp
</code></pre>

<h1>
<a name="starting-the-gemfire-data-grid" class="anchor" href="#starting-the-gemfire-data-grid"><span class="octicon octicon-link"></span></a>Starting the GemFire data grid</h1>

<p>Please <a href="http://gemfire.docs.pivotal.io/latest/userguide/index.html#getting_started/install_intro.html">install GemFire for your operating system</a>. Now, let us start a GemFire cluster to store your data; GemFire cluster is made up of two types of members, “locators” and “servers”. A locator is a service that enables GemFire servers to discover each other, facilitates load balancing etc. From GemFireSHell (gfsh) start a locator as follows: (For high availability, you should start more than one locator per cluster)</p>

<pre><code>gfsh&gt;start locator --name=locator1
</code></pre>

<p>A GemFire “server” is a process which manages your data. All nodes talk to one another. A server can be stated as follows</p>

<pre><code>gfsh&gt;start server --name=server1
</code></pre>

<p>A server with a REST endpoint can be stated as follows</p>

<pre><code>gfsh&gt;start server --name=server2 --J=-Dgemfire.start-dev-rest-api=true --J=-Dgemfire.http-service-port=8080
</code></pre>

<p>Let us create Regions (RDBMS equivalent of Tables) to stores this data</p>

<pre><code>gfsh&gt;create region --name=profiles --type=REPLICATE
</code></pre>

<p>A replicate region maintains a copy of the entire data on each server</p>

<pre><code>gfsh&gt;create region --name=posts --type=PARTITION
</code></pre>

<p>A partitioned region splits its contents among all servers</p>

<h1>
<a name="writing-python-application" class="anchor" href="#writing-python-application"><span class="octicon octicon-link"></span></a>Writing Python Application</h1>

<p>Now that we have the GemFire RESTful service started, we can create our client instance and store data:</p>

<pre><code>#create client using hostname and port of GemFire’s REST service endpoint
client = GemfireClient(hostname="localhost", port=8080)

#create a repository for storing profiles
profiles = client.create_repository(“profiles”)

#save profiles in GemFire
user1 = Profile(1, “Ethan”)
profiles.save(user1)

#you can also pass a list of entities, efficient for bulk loading
post1 = Post(1, "Ethan", "Eating Toast!")
post2 = Post(2, "Isabella", "Drinking Coffee")
posts = client.create_repository("posts")
posts.save([post1, post2])

# find an existing profile
user2 = profiles.find(1)
</code></pre>

<p>A complete list of methods for GemfireClient and the Repository modules:</p>

<p>For specialized operations on the Region like compare and set, putIfAbsent etc. you can obtain the Region directly from the repository:
profile_region = profiles.get_region()
A complete list of Region methods is:</p>

<h1>
<a name="query" class="anchor" href="#query"><span class="octicon octicon-link"></span></a>Query</h1>

<p>GemFire supports OQL queries. For an example, let us say we want to get all posts by Ethan. We can write an ad-hoc query as follows:</p>

<pre><code>result = client.adhoc_query("select * from /posts where author='Ethan' ")
    for p in result:
        print p.status
</code></pre>

<p>When we want to use the above query for a different author, we can create a prepared query by passing an identifier for the prepared query along with the actual query string. We can use the identifier to run a prepared query at a later point. In the below example, we create a prepared query identified by “all_posts” and later use that identifier to run the query by passing in the parameters.</p>

<pre><code>    client.new_query("all_posts", "select * from /posts where author=$1")
    result = client.run_query("all_posts", "Ethan")
    for p in result:
        print p.status
</code></pre>

<h1>
<a name="accessing-data-from-other-languages" class="anchor" href="#accessing-data-from-other-languages"><span class="octicon octicon-link"></span></a>Accessing data from Other Languages</h1>

<p>GemFire internally saves this data in its Portable Data eXchange format (PDX), so it is possible to access and modify the data inserted from python in other languages. The following code snippet demonstrates how this can be done from GemFire’s Java client:</p>

<pre><code>ClientCacheFactory cf = new ClientCacheFactory();
        cf.addPoolLocator(“localhost”, 10334);
        ClientCache cache = cf.create();
        ClientRegionFactory&lt;Integer, Profile&gt; rf = cache.createClientRegionFactory(ClientRegionShortcut.PROXY);
        Region profiles = rf.create("profiles");
        PdxInstance user1 = (PdxInstance) profiles.get("1");
        System.out.println("get returned:"+user1.getField("name")); //prints Ethan
        WritablePdxInstance userModified = user1.createWriter();
        userModified.setField("name", "Ethan Jr");
        profiles.put("1", userModified);
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Py-gemfire-rest maintained by <a href="https://github.com/gemfire">gemfire</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
